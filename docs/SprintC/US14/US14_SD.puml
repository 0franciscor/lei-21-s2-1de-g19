@startuml
'https://plantuml.com/sequence-diagram

autonumber
actor "Specialist Doctor" as SD
activate SD
activate "WriteTestReportUI"
SD -> "WriteTestReportUI" : starts writing test report
"WriteTestReportUI" -> "WriteTestReportController" : getAnalyzedTests()
activate "WriteTestReportController"
"WriteTestReportController" -> "TestStore" : getAnalyzedTests()
activate "TestStore"
deactivate "TestStore"
"WriteTestReportController" -> "TestMapper" : toDto()
activate "TestMapper"
deactivate "TestMapper"
"WriteTestReportUI" -> SD : shows list of analyzed test
SD -> "WriteTestReportUI" : selects a analyzed test to make a diagnosis report
"WriteTestReportUI" -> "WriteTestReportController" : getReferenceValues(test)
"WriteTestReportController" -> "Test" : getReferenceValues(test)
activate "Test"
"Test" -> "Test" : getReferenceValues()
"WriteTestReportUI" -> SD : shows the reference values and requests data
deactivate "Test"
SD -> "WriteTestReportUI" : types the requested data
"WriteTestReportUI" -> SD : shows the typed data and requests confirmation
SD -> "WriteTestReportUI" :  confirms the data
"WriteTestReportController" -> "Test" : testcode = getTestCode(test)
activate "Test"
deactivate "Test"
"WriteTestReportUI" -> "WriteTestReportController" : saveReport(report, testcode)
"WriteTestReportController" -> "rep: Report" : saveReport(report, testcode)
activate "rep: Report"
"rep: Report" -> "rep: Report" : validateReport(report)
"rep: Report" -> "rep: Report" : rep = create(report, testcode)
"rep: Report" -> "ReportStore" : addReport(rep)
"WriteTestReportUI" -> SD : informs the success of the operation


@enduml