# US 15 - As a laboratory coordinator, I want to validate the work done by the clinical chemistry technologist and specialist doctor.

## 1. Requirements Engineering

### 1.1. User Story Description

* As a laboratory coordinator, I want to validate the work done by the clinical chemistry technologist and specialist doctor.

### 1.2. Customer Specifications and Clarifications

**From the specifications document:**

* "To validate the work done, the laboratory coordinator checks the chemical test/result and associated diagnosis made and confirms that everything was done correctly. "

* "Once the laboratory coordinator confirms that everything was done correctly, the client receives a notification alerting that the results are already available in the central application and informing that he/she must access the application to view those results."

**From the client clarifications:**

* Question: What stages of validation should be considered? [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8174#p10701)
    * Answer: (yet to be answered) 
  
  
* Question: Should the tests be validated one by one, or as a group? [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8180#p10708)
    * Answer: "The coordinator can validate all or a subset of test results."
  

* Question: Is the test sent to the laboratory coordinator or does he fetch it through a code? [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8177#p10704)
    * Answer: "The system shows all tests ready to validate (tests that already have the test registration date, the chemical analysis date and the diagnosis date registered in the system) and the laboratory coordinator selects one or more tests to mark as validated."
  

* Question: What if a certain test is invalid? Should it be scrapped or have the laboratory Coordinator propose to redo it? [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8177#p10704)
    * Answer: The objective is for the laboratory coordinator to be aware of the work developed in the chemical laboratory and to mark the job as done.
    

* Question: Can "Valid" or "Invalid" be accepted as a confirmation? If so, are these states available from a list of options? [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8251#p10789)
    * Answer: "Only Valid state, and the laboratory coordinator selects one or more tests to mark as validated.
  

* Question: What information does the laboratory coordinator need to validate a test? 
    * Answer: Only the dates. Moreover, it should record the validation date. [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8270&parent=10817#p11004)
  

* Question: After validation do we need to have the time and date of the validation?
    * Answer: Yes, the system should record the date (DD/MM/YYYY) and time (HH:MM) when the validation was made.
      Moreover, in this US, when the system shows to the laboratory coordinator all the dates (test registration date, chemical analysis date and diagnosis date), the system should show the date (DD/MM/YYYY) and the time (HH:MM). [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8408#p11169)


* Question: After performing validation, does the client get sent a notification informing the test has became available to see its results?
    * Answer: From the Project Description: "Once the laboratory coordinator confirms that everything was done correctly, the client receives a notification alerting that the results are already available in the central application and informing that he/she must access the application to view those results."
      * "During the development of the Integrative Project we will not use any e-mail or SMS API services to send messages. All the e-mail and SMS messages should be written to a file with the name emailAndSMSMessages.txt. This file simulates the use of e-mail and SMS API services. "
      [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8330#p10899)
        

* Question: What should happen to a test if either the test report or the results are invalid? Should we prompt for a redo of either process or simply erase the test?
    * Answer: The laboratory coordinator only sees the test dates of tests that already have all dates registered in the system (test registration date, the chemical analysis date and the diagnosis date). [Client Forum](https://moodle.isep.ipp.pt/mod/forum/discuss.php?d=8177#p10888)

### 1.3. Acceptance Criteria

* AC1: The system does not show client personal information but shows all dates (test registration date, chemical analysis date and diagnosis date).
* AC2: During the development of the Integrative Project we will not use any e-mail or SMS API services to send messages.

### 1.4. Found out Dependencies

* US12: As a clinical chemistry technologist, I intend to record the results of a given test.

* US14: As a specialist doctor, I intend to make the diagnosis and write a report for a given test.

### 1.5 Input and Output Data

**Input data**

* Typed data: (none)
* Selected data: Chosen Tests, Validation State.


**Output data**
*   List of tests available for validation
*   Chosen tests data
*   Chosen validation state
*  (In)Success of the operation of defining a certain Test and saving it.

### 1.6. System Sequence Diagram (SSD)

![US15-SSD](US15-SSD.svg)

### 1.7 Other Relevant Remarks

* Regarding the process of having a certain test to a client, this US can be considered as the final step of the process, since the one that follows, is described as sending the results as notification to the client. 

## 2. OO Analysis

### 2.1. Relevant Domain Model Excerpt

![US15-MD](US15-MD.svg)

### 2.2. Other Remarks

The US15 totally relies on the previous US contents, since its function is to validate a performed Test, which requires many other components. 

## 3. Design - User Story Realization 

### 3.1. Rationale

**The rationale grounds on the SSD interactions and the identified input/output data.**

| Interaction ID | Question: Which class is responsible for... | Answer  | Justification (with patterns)  |
|:-------------  |:--------------------- |:------------|:---------------------------- |
| Step 1: validate a Test Result/Diagnosis      | ...validating a result?  | validateTestUI | Pure Fabrication: Assign a highly cohesive set of responsibilities to an artificial or convenience "behavior", which will later be reused.
|                                               | ...coordinating the US?  | validateTestController| Controller (Handles a UI event).
| Step 2: shows a list of to-be validated tests | ...showing the available states? | validateTestUI | IE: responsible for storing the tests ready for validation.
| Step 3: selects a test from the list          | ...making the list available? | TestStore | Creator: TestStore is responsible for showing all tests available for validation (TestStore records tests).
| Step 4: displays its data and requests to chose a validation state | ...requesting the data? | validateTestUI | IE: responsible for user interaction.
| Step 5: selects the desired state             | ...saving the selected state? | validateTestController | Controller (Handles the validation received).
| Step 6: shows it and requests a confirmation  | ... validating the data locally? | validateTestUI | IE: knows the possible validation states.
| Step 7: confirms the selected state           | ... saving the selected data?  | TestStore | Creator: TestStore is responsible for saving the validation state.
| Step 8: informs about the operation success | ...informing addition success? | validateTestUI | IE: responsible for user interaction

### Systematization ##

According to the taken rationale, the conceptual classes promoted to software classes are: 

 * TestStore

Other software classes (i.e. Pure Fabrication) identified: 
 
 * validateTestUI
 * validateTestController

## 3.2. Sequence Diagram (SD)

![US15-SD](US15-SD.svg)

## 3.3. Class Diagram (CD)

![US15-CD](US15-CD.svg)

# 4. Tests

**Test 1:** Tests if (description)

# 5. Construction (Implementation)

 * ValidateTestController Class

        public class ValidateTestController {
    
            public ValidateTestController(){}
        
            public List<TestDto> getAllTestsDto(){}
        
            public boolean validateReport(String code){}
        
            public boolean validateTest(String code){}
        
            public void sendNotification(){}
        }
  
* TestMapper Class

        public class TestMapper {

            public static List<TestDto> toDto (List<Test> listTest){}
        
            public static List<TestDto> toDtoLabC (List<Test> testsList){}
        
            public static List<TestDto> ModelToDto (List<Test> listTest){}
        
            public static TestDto ModelToDto (Test test){}
        
            public static String DtoToModel (TestDto testDto){}
        }

* TestStore Class

        public class TestStore {

            private List<Test> TestList;


            public TestStore (){}

            public List<Test> getDiagnosedTests(){}

            public Test getTestByCode(String code){}

            public boolean validateTest(Test test){}
        }

* ReportStore Class

        public class ReportStore {
            
            private List<Report> reportList;
  

            public boolean validateReport(String code){}

        }

* Company Class

        public class Company {
  
            private ReportStore reportStore;
        
            private TestStore testStore;

            private Notification notification;


            public Company(String designation){}
    
            public TestStore getTestStore(){}
      
            public ReportStore getReportStore (){}
            
            public Notification getNotificationService(){}
  
        }

* Report Class

        public class Report{
        
            private boolean validation;
  
            private String testCode;
  

            public Report (String report, String testcode){}
  
            public boolean getValidation(){}
  
            public void setValidation(boolean validation){}
  
        }

* TestDto class

        public class TestDto{
  
            private Date registrationDateTime;
  
            private Date chemicalAnalysisDateTime;
  
            private Date diagnosisDateTime;
  
            private String code;


            public TestDto(Date registrationDateTime, Date chemicalAnalysisDateTime, Date diagnosisDateTime, String code){}
    
            public Date getRegistrationDateTime(){}
    
            public Date getChemicalAnalysisDateTime(){}
    
            public Date getDiagnosisDateTime(){}
        }

* Test Class
        
        public class Test {

            private Date registrationDateTime;
  
            private Date collectDateTime;
  
            private Date chemicalAnalysisDateTime;
  
            private Date diagnosisDateTime;
  
            private Date validationDateTime;


            public String getStatus(){}

            public boolean updateValidationDateTime(){}

            public void updateTestStatus(){}
        
        }

* Notification class


        public class Notification {
        
            private PrintWriter out;

        
            public Notification(){}
        
            public void writeToFile(String message){}
        }

# 6. Integration and Demo 



# 7. Observations****

